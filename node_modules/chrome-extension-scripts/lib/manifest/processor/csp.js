'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

exports.default = function (manifest) {
  log.pending("Processing CSP");

  if (process.env.NODE_ENV == 'development') {

    var csp = manifest["content_security_policy"] || "";

    var objectSrc = "object-src 'self'";

    if (~csp.indexOf('object-src')) {
      csp = csp.replace('object-src', objectSrc);
    } else {
      csp = objectSrc + '; ' + csp;
    }

    // TODO add host into some config
    var scriptSrc = "script-src 'self' 'unsafe-eval' https://localhost:3001";

    if (~csp.indexOf('script-src')) {
      csp = csp.replace('script-src', scriptSrc);
    } else {
      csp = scriptSrc + '; ' + csp;
    }

    manifest["content_security_policy"] = csp;

    log.done("Done");
  } else {
    log.done("Skipped in production environment");
  }

  return { manifest: manifest };
};

var _log = require('../../utils/log');

var log = _interopRequireWildcard(_log);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9tYW5pZmVzdC9wcm9jZXNzb3IvY3NwLmpzIl0sIm5hbWVzIjpbIm1hbmlmZXN0IiwibG9nIiwicGVuZGluZyIsInByb2Nlc3MiLCJlbnYiLCJOT0RFX0VOViIsImNzcCIsIm9iamVjdFNyYyIsImluZGV4T2YiLCJyZXBsYWNlIiwic2NyaXB0U3JjIiwiZG9uZSJdLCJtYXBwaW5ncyI6Ijs7Ozs7O2tCQUllLFVBQVNBLFFBQVQsRUFBbUI7QUFDaENDLE1BQUlDLE9BQUosQ0FBWSxnQkFBWjs7QUFFQSxNQUFHQyxRQUFRQyxHQUFSLENBQVlDLFFBQVosSUFBd0IsYUFBM0IsRUFBMEM7O0FBRXhDLFFBQUlDLE1BQU1OLFNBQVMseUJBQVQsS0FBdUMsRUFBakQ7O0FBRUEsUUFBTU8sWUFBWSxtQkFBbEI7O0FBRUEsUUFBRyxDQUFDRCxJQUFJRSxPQUFKLENBQVksWUFBWixDQUFKLEVBQStCO0FBQzdCRixZQUFNQSxJQUFJRyxPQUFKLENBQVksWUFBWixFQUEwQkYsU0FBMUIsQ0FBTjtBQUNELEtBRkQsTUFFTztBQUNMRCxZQUFTQyxTQUFULFVBQXVCRCxHQUF2QjtBQUNEOztBQUVEO0FBQ0EsUUFBTUksWUFBWSx3REFBbEI7O0FBRUEsUUFBRyxDQUFDSixJQUFJRSxPQUFKLENBQVksWUFBWixDQUFKLEVBQStCO0FBQzdCRixZQUFNQSxJQUFJRyxPQUFKLENBQVksWUFBWixFQUEwQkMsU0FBMUIsQ0FBTjtBQUNELEtBRkQsTUFFTztBQUNMSixZQUFTSSxTQUFULFVBQXVCSixHQUF2QjtBQUNEOztBQUVETixhQUFTLHlCQUFULElBQXNDTSxHQUF0Qzs7QUFFQUwsUUFBSVUsSUFBSixDQUFTLE1BQVQ7QUFDRCxHQXhCRCxNQXdCTztBQUNMVixRQUFJVSxJQUFKLENBQVMsbUNBQVQ7QUFDRDs7QUFFRCxTQUFPLEVBQUNYLGtCQUFELEVBQVA7QUFDRCxDOztBQXBDRDs7SUFBWUMsRyIsImZpbGUiOiJjc3AuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgKiBhcyBsb2cgZnJvbSAnLi4vLi4vdXRpbHMvbG9nJ1xuXG4vLy8vLy8vLy8vXG4vLyBDU1AuIEZpeCBDb250ZW50IHNlY3VyaXR5IHBvbGljeSB0byBhbGxvdyBldmFsIHdlYnBhY2sgc2NyaXB0cyBpbiBkZXZlbG9wbWVudCBtb2RlXG5leHBvcnQgZGVmYXVsdCBmdW5jdGlvbihtYW5pZmVzdCkge1xuICBsb2cucGVuZGluZyhcIlByb2Nlc3NpbmcgQ1NQXCIpXG5cbiAgaWYocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT0gJ2RldmVsb3BtZW50Jykge1xuXG4gICAgbGV0IGNzcCA9IG1hbmlmZXN0W1wiY29udGVudF9zZWN1cml0eV9wb2xpY3lcIl0gfHwgXCJcIlxuXG4gICAgY29uc3Qgb2JqZWN0U3JjID0gXCJvYmplY3Qtc3JjICdzZWxmJ1wiXG5cbiAgICBpZih+Y3NwLmluZGV4T2YoJ29iamVjdC1zcmMnKSkge1xuICAgICAgY3NwID0gY3NwLnJlcGxhY2UoJ29iamVjdC1zcmMnLCBvYmplY3RTcmMpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNzcCA9IGAke29iamVjdFNyY307ICR7Y3NwfWBcbiAgICB9XG5cbiAgICAvLyBUT0RPIGFkZCBob3N0IGludG8gc29tZSBjb25maWdcbiAgICBjb25zdCBzY3JpcHRTcmMgPSBcInNjcmlwdC1zcmMgJ3NlbGYnICd1bnNhZmUtZXZhbCcgaHR0cHM6Ly9sb2NhbGhvc3Q6MzAwMVwiXG5cbiAgICBpZih+Y3NwLmluZGV4T2YoJ3NjcmlwdC1zcmMnKSkge1xuICAgICAgY3NwID0gY3NwLnJlcGxhY2UoJ3NjcmlwdC1zcmMnLCBzY3JpcHRTcmMpXG4gICAgfSBlbHNlIHtcbiAgICAgIGNzcCA9IGAke3NjcmlwdFNyY307ICR7Y3NwfWBcbiAgICB9XG5cbiAgICBtYW5pZmVzdFtcImNvbnRlbnRfc2VjdXJpdHlfcG9saWN5XCJdID0gY3NwXG5cbiAgICBsb2cuZG9uZShcIkRvbmVcIilcbiAgfSBlbHNlIHtcbiAgICBsb2cuZG9uZShcIlNraXBwZWQgaW4gcHJvZHVjdGlvbiBlbnZpcm9ubWVudFwiKVxuICB9XG5cbiAgcmV0dXJuIHttYW5pZmVzdH1cbn1cbiJdfQ==