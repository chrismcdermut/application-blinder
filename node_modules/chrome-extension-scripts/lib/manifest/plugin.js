"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();

var _SingleEntryPlugin = require("webpack/lib/SingleEntryPlugin");

var _SingleEntryPlugin2 = _interopRequireDefault(_SingleEntryPlugin);

var _MultiEntryPlugin = require("webpack/lib/MultiEntryPlugin");

var _MultiEntryPlugin2 = _interopRequireDefault(_MultiEntryPlugin);

var _remove = require("../utils/remove");

var Remove = _interopRequireWildcard(_remove);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

var ManifestPlugin = function () {
  function ManifestPlugin(Manifest) {
    _classCallCheck(this, ManifestPlugin);

    this.Manifest = Manifest;
    this.isDevelopment = process.env.NODE_ENV !== "production";
  }

  _createClass(ManifestPlugin, [{
    key: "apply",
    value: function apply(compiler) {
      var _this = this;

      this.Manifest.run();

      this.Manifest.scripts.forEach(function (script) {
        // name
        var name = Remove.extension(script);

        // item
        var item = void 0;
        if (_this.isDevelopment) {
          item = [require.resolve('webpack-dev-server/client') + '?https://localhost:3001', require.resolve('webpack/hot/only-dev-server'), script];
        } else {
          item = script;
        }

        var entryClass = _this.itemToPlugin(item, name);

        compiler.apply(entryClass);
      });
    }
  }, {
    key: "itemToPlugin",
    value: function itemToPlugin(item, name) {
      if (Array.isArray(item)) {
        return new _MultiEntryPlugin2.default(null, item, name);
      } else {
        return new _SingleEntryPlugin2.default(null, item, name);
      }
    }
  }]);

  return ManifestPlugin;
}();

exports.default = ManifestPlugin;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tYW5pZmVzdC9wbHVnaW4uanMiXSwibmFtZXMiOlsiUmVtb3ZlIiwiTWFuaWZlc3RQbHVnaW4iLCJNYW5pZmVzdCIsImlzRGV2ZWxvcG1lbnQiLCJwcm9jZXNzIiwiZW52IiwiTk9ERV9FTlYiLCJjb21waWxlciIsInJ1biIsInNjcmlwdHMiLCJmb3JFYWNoIiwic2NyaXB0IiwibmFtZSIsImV4dGVuc2lvbiIsIml0ZW0iLCJyZXF1aXJlIiwicmVzb2x2ZSIsImVudHJ5Q2xhc3MiLCJpdGVtVG9QbHVnaW4iLCJhcHBseSIsIkFycmF5IiwiaXNBcnJheSJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7OztBQUNBOzs7O0FBQ0E7O0lBQVlBLE07Ozs7Ozs7O0lBRVNDLGM7QUFDbkIsMEJBQVlDLFFBQVosRUFBc0I7QUFBQTs7QUFDcEIsU0FBS0EsUUFBTCxHQUFnQkEsUUFBaEI7QUFDQSxTQUFLQyxhQUFMLEdBQXFCQyxRQUFRQyxHQUFSLENBQVlDLFFBQVosS0FBeUIsWUFBOUM7QUFDRDs7OzswQkFFS0MsUSxFQUFVO0FBQUE7O0FBQ2QsV0FBS0wsUUFBTCxDQUFjTSxHQUFkOztBQUVBLFdBQUtOLFFBQUwsQ0FBY08sT0FBZCxDQUFzQkMsT0FBdEIsQ0FBOEIsVUFBQ0MsTUFBRCxFQUFZO0FBQ3hDO0FBQ0EsWUFBTUMsT0FBT1osT0FBT2EsU0FBUCxDQUFpQkYsTUFBakIsQ0FBYjs7QUFFQTtBQUNBLFlBQUlHLGFBQUo7QUFDQSxZQUFHLE1BQUtYLGFBQVIsRUFBdUI7QUFDckJXLGlCQUFPLENBQ0xDLFFBQVFDLE9BQVIsQ0FBZ0IsMkJBQWhCLElBQStDLHlCQUQxQyxFQUVMRCxRQUFRQyxPQUFSLENBQWdCLDZCQUFoQixDQUZLLEVBR0xMLE1BSEssQ0FBUDtBQUtELFNBTkQsTUFNTztBQUNMRyxpQkFBT0gsTUFBUDtBQUNEOztBQUVELFlBQU1NLGFBQWEsTUFBS0MsWUFBTCxDQUFrQkosSUFBbEIsRUFBd0JGLElBQXhCLENBQW5COztBQUVBTCxpQkFBU1ksS0FBVCxDQUFlRixVQUFmO0FBQ0QsT0FuQkQ7QUFvQkQ7OztpQ0FFWUgsSSxFQUFNRixJLEVBQU07QUFDdkIsVUFBR1EsTUFBTUMsT0FBTixDQUFjUCxJQUFkLENBQUgsRUFBd0I7QUFDdEIsZUFBTywrQkFBcUIsSUFBckIsRUFBMkJBLElBQTNCLEVBQWlDRixJQUFqQyxDQUFQO0FBQ0QsT0FGRCxNQUVPO0FBQ0wsZUFBTyxnQ0FBc0IsSUFBdEIsRUFBNEJFLElBQTVCLEVBQWtDRixJQUFsQyxDQUFQO0FBQ0Q7QUFDRjs7Ozs7O2tCQXJDa0JYLGMiLCJmaWxlIjoicGx1Z2luLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IFNpbmdsZUVudHJ5UGx1Z2luIGZyb20gXCJ3ZWJwYWNrL2xpYi9TaW5nbGVFbnRyeVBsdWdpblwiXG5pbXBvcnQgTXVsdGlFbnRyeVBsdWdpbiBmcm9tIFwid2VicGFjay9saWIvTXVsdGlFbnRyeVBsdWdpblwiXG5pbXBvcnQgKiBhcyBSZW1vdmUgZnJvbSAnLi4vdXRpbHMvcmVtb3ZlJ1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBNYW5pZmVzdFBsdWdpbiB7XG4gIGNvbnN0cnVjdG9yKE1hbmlmZXN0KSB7XG4gICAgdGhpcy5NYW5pZmVzdCA9IE1hbmlmZXN0XG4gICAgdGhpcy5pc0RldmVsb3BtZW50ID0gcHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiXG4gIH1cblxuICBhcHBseShjb21waWxlcikge1xuICAgIHRoaXMuTWFuaWZlc3QucnVuKClcblxuICAgIHRoaXMuTWFuaWZlc3Quc2NyaXB0cy5mb3JFYWNoKChzY3JpcHQpID0+IHtcbiAgICAgIC8vIG5hbWVcbiAgICAgIGNvbnN0IG5hbWUgPSBSZW1vdmUuZXh0ZW5zaW9uKHNjcmlwdClcblxuICAgICAgLy8gaXRlbVxuICAgICAgbGV0IGl0ZW1cbiAgICAgIGlmKHRoaXMuaXNEZXZlbG9wbWVudCkge1xuICAgICAgICBpdGVtID0gW1xuICAgICAgICAgIHJlcXVpcmUucmVzb2x2ZSgnd2VicGFjay1kZXYtc2VydmVyL2NsaWVudCcpICsgJz9odHRwczovL2xvY2FsaG9zdDozMDAxJyxcbiAgICAgICAgICByZXF1aXJlLnJlc29sdmUoJ3dlYnBhY2svaG90L29ubHktZGV2LXNlcnZlcicpLFxuICAgICAgICAgIHNjcmlwdFxuICAgICAgICBdXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpdGVtID0gc2NyaXB0XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGVudHJ5Q2xhc3MgPSB0aGlzLml0ZW1Ub1BsdWdpbihpdGVtLCBuYW1lKVxuXG4gICAgICBjb21waWxlci5hcHBseShlbnRyeUNsYXNzKVxuICAgIH0pXG4gIH1cblxuICBpdGVtVG9QbHVnaW4oaXRlbSwgbmFtZSkge1xuICAgIGlmKEFycmF5LmlzQXJyYXkoaXRlbSkpIHtcbiAgICAgIHJldHVybiBuZXcgTXVsdGlFbnRyeVBsdWdpbihudWxsLCBpdGVtLCBuYW1lKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIG5ldyBTaW5nbGVFbnRyeVBsdWdpbihudWxsLCBpdGVtLCBuYW1lKTtcbiAgICB9XG4gIH1cbn1cbiJdfQ==